---
title: "Rails7へアップグレード時に気をつけること"
emoji: "😺"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["rails6","rails7","アップグレード"]
published: false # trueを指定する
---

> csrf.js

```javascript
function set_csrftoken() {
    $.ajaxPrefilter(function (options, originalOptions, jqXHR) {
        if (!options.crossDomain) {
            const token = $('meta[name="csrf-token"]').attr('content');
            if (token) {
                return jqXHR.setRequestHeader('X-CSRF-Token', token);
            }
        }
    });
}
 
function ajax() {
    set_csrftoken()
}
```

上記コード

> app/assets/javascripts/csrf.js

```markdown
Rails6からRails7にアップグレードするプロジェクトに配置すると、

CSRF対策またはCSRFトークンに悩まされることはなくなります。
```

どうしてもRails7アップグレード時、CSRF対策に困っているとき参考にどうぞ。
